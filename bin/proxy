#!/usr/bin/env node

process.title = 'proxy';

/**
 * Module dependencies.
 */

var program = require('commander');

program
  .version(require('../package.json').version)
  .option('-p, --port <n>', 'TCP port number to bind to', 3128, Number)
  .parse(process.argv);

var http = require('http');
var setup = require('../');
var basicAuthParser = require('basic-auth-parser');

/**
 * Setup the HTTP "proxy server" instance.
 */

var proxy = http.createServer();
setup(proxy);

/**
 * Outbound proxy requests will use `agent: false`.
 */

proxy.agent = false;

/**
 * Bind to port.
 */

proxy.listen(program.port, function () {
  console.log('HTTP(s) proxy server listening on port %d', this.address().port);
});
